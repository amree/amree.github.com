<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>xen on Amree Zaid</title><link>https://amree.github.io/tags/xen/</link><description>Recent content in xen on Amree Zaid</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Wed, 12 Sep 2012 00:00:00 +0000</lastBuildDate><atom:link href="https://amree.github.io/tags/xen/index.xml" rel="self" type="application/rss+xml"/><item><title>Getting Started with Xen on Slackware</title><link>https://amree.github.io/2012/09/12/getting-started-with-xen-on-slackware/</link><pubDate>Wed, 12 Sep 2012 00:00:00 +0000</pubDate><guid>https://amree.github.io/2012/09/12/getting-started-with-xen-on-slackware/</guid><description>&lt;p>Here&amp;rsquo;s a guide on how to setup Xen virtualization in Slackware.&lt;/p></description><content>&lt;p>Here&amp;rsquo;s a guide on how to setup Xen virtualization in Slackware.&lt;/p>
&lt;h2 id="install-slackware">Install Slackware&lt;/h2>
&lt;p>I&amp;rsquo;ll be doing this on Slackware v13.37 64 bit.&lt;/p>
&lt;ul>
&lt;li>Create 1 partition for the whole disk&lt;/li>
&lt;li>Set its type to &lt;code>8e&lt;/code> (Linux LVM)&lt;/li>
&lt;/ul>
&lt;p>Run these commands to setup the LVM partitions:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">pvcreate /dev/sda1
vgcreate vg01 /dev/sda1
lvcreate -L 20G -n root vg01
lvcreate -L 20G -n iso vg01
lvcreate -L 8G -n swap vg01
mkswap /dev/vg01/swap
setup
&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>Mount &lt;code>/dev/vg01/root&lt;/code> as &lt;code>/&lt;/code>&lt;/li>
&lt;li>Mount &lt;code>/dev/vg01/iso&lt;/code> as &lt;code>/iso&lt;/code>&lt;/li>
&lt;li>Install all packages from a, ap, d, f, l, n, t, tcl, x&lt;/li>
&lt;/ul>
&lt;p>Create custom &lt;code>initrd&lt;/code> after the setup complete:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">chroot /mnt
/usr/share/mkinitrd/mkinitrd_command_generator.sh &amp;gt; init
sh init
ln -sf /boot/vmlinuz-generic-2.6.37.6 /boot/vmlinuz
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Add &lt;code>initrd&lt;/code> option in your &lt;code>/etc/lilo.conf&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-txt" data-lang="txt"># /etc/lilo.conf
image = /boot/vmlinuz
initrd = /boot/initrd.gz # Add this line
root = /dev/vg01/root
label = slackware
read-only # Partitions should be mounted read-only for checking
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Install the new bootloader and reboot:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">lilo
exit
reboot
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="setup-dom0-host">Setup Dom0 (Host)&lt;/h2>
&lt;h3 id="install-xen">Install Xen&lt;/h3>
&lt;ul>
&lt;li>Install &lt;a href="http://slackbuilds.org/repository/13.37/development/acpica/">acpica&lt;/a>&lt;/li>
&lt;li>Install &lt;a href="http://slackbuilds.org/repository/13.37/system/xen/">xen&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="build-xen-kernel">Build Xen Kernel&lt;/h3>
&lt;p>We&amp;rsquo;ll be using kernel v3.2.28 so that no patching will be required to enable Xen
and for that we&amp;rsquo;ll get the one from Slackware&amp;rsquo;s repo. By the time of this
writing, Slackware v14 has not been released yet (it&amp;rsquo;s in the current).&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">wget http://slackware.osuosl.org/slackware-current/source/k/linux-3.2.28.tar.xz
tar Jxvf linux-3.2.28.tar.xz
mv linux-3.2.28 linux-3.2.28-xen
mv linux-3.2.28-xen/ /usr/src/
cd /usr/src
rm linux
ln -s linux-3.2.28-xen linux
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Get Slackware&amp;rsquo;s default kernel config for a start. From there, you must add all
Xen&amp;rsquo;s related kernel configs. You can refer to &lt;a href="http://wiki.xen.org/wiki/Mainline_Linux_Kernel_Configs">Xen&amp;rsquo;s
wiki&lt;/a> on what kernel
config that needs to be enabled.&lt;/p>
&lt;p>You can also get my configs from this &lt;a href="https://gist.github.com/3695518">gist&lt;/a>.
It&amp;rsquo;s based on 3.2.28 kernel (you can use Gist&amp;rsquo;s diff to see what config I&amp;rsquo;ve
added).&lt;/p>
&lt;p>Whatever you chose, make sure you&amp;rsquo;ll change the LOCALVERSION so that you won&amp;rsquo;t
replace your current kernel. Use &lt;code>cat /proc/cpuinfo | grep -i 'processor' | wc -l&lt;/code> + 1 to get your cpu core count to be used with &lt;code>make -j&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">cd linux
wget http://slackware.osuosl.org/slackware-current/source/k/config-x86_64/config-generic-3.2.28.x64
cp config-generic-3.2.28.x64 .config
make oldconfig
make menuconfig
make -j13 bzImage modules
make modules_install
cp System.map /boot/System.map-xen-3.2.28
cp .config /boot/config-xen-3.2.28
cd /boot
rm System.map
ln -s System.map-xen-3.2.28 System.map
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="xen--dom0--initrd">Xen + Dom0 + Initrd&lt;/h3>
&lt;p>Since LILO doesn&amp;rsquo;t support &amp;ldquo;module&amp;rdquo; directive of Grub, we need to use &lt;code>mbootpack&lt;/code>.&lt;/p>
&lt;ul>
&lt;li>Install &lt;a href="http://slackbuilds.org/repository/13.37/system/mbootpack/">mbootpack&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>You can use &lt;code>/usr/share/mkinitrd/mkinitrd_command_generator.sh&lt;/code> for &lt;code>mkinitrd&lt;/code>
recommendation. Create an initrd for Xen&amp;rsquo;s kernel:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">depmod 3.2.28-xen
mkinitrd -c -k 3.2.28-xen -f ext4 -r /dev/vg01/root -m mptbase:mptscsih:mptsas:usbhid:ehci-hcd:uhci-hcd:jbd2:mbcache:ext4 -L -u -o /boot/initrd-xen.gz
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Create the boot image using &lt;code>mbootpack&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">cd /boot
gzip -d -c /boot/xen-4.1.2.gz &amp;gt; /boot/xen-4.1.2
gzip -d -c /boot/initrd-xen.gz &amp;gt; /boot/initrd-xen
mbootpack -o /boot/vmlinuz-xen-3.2.28 -m /usr/src/linux-3.2.28-xen/vmlinux -m /boot/initrd-xen /boot/xen-4.1.2
ln -s vmlinuz-xen-3.2.28 vmlinuz-xen
&lt;/code>&lt;/pre>&lt;/div>&lt;p>With &lt;code>mbootpack&lt;/code>, we don&amp;rsquo;t have to specify &lt;code>initrd&lt;/code> option. Add these new configs into your &lt;code>/etc/lilo.conf&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-txt" data-lang="txt"># /etc/lilo.conf
image = /boot/vmlinuz-xen
root = /dev/vg01/root
label = slackware-xen
append=&amp;#34;-- nomodeset&amp;#34;
read-only
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Put these configs on the top of your &lt;code>lilo.conf&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-txt" data-lang="txt">default = slackware-xen
timeout = 30
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Run &lt;code>lilo&lt;/code> and make sure there&amp;rsquo;s no error from the output:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ lilo
Warning: LBA32 addressing assumed
Added slackware
Added slackware-xen *
One warning was issued.
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Put these settings in your &lt;code>/etc/rc.d/rc.local&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-txt" data-lang="txt"># /etc/rc.d/rc.local
if [ -d /proc/xen ]; then
if [ -x /etc/rc.d/rc.xencommons ]; then
echo &amp;#34;Starting XEN commons: /etc/rc.d/rc.xencommons&amp;#34;
/etc/rc.d/rc.xencommons start
fi
if [ -x /etc/rc.d/rc.xendomains ]; then
echo &amp;#34;Starting XEN domains: /etc/rc.d/rc.xendomains&amp;#34;
/etc/rc.d/rc.xendomains start
fi
fi
&lt;/code>&lt;/pre>&lt;/div>&lt;p>And these commands in your &lt;code>/etc/rc.d/rc.local_shutdown&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-txt" data-lang="txt"># /etc/rc.d/rc.local_shutdown
if [ -d /proc/xen ]; then
if [ -x /etc/rc.d/rc.xendomains ]; then
echo &amp;#34;Stopping XEN domains: /etc/rc.d/rc.xendomains&amp;#34;
/etc/rc.d/rc.xendomains stop
fi
if [ -x /etc/rc.d/rc.xencommons ]; then
echo &amp;#34;Stopping XEN commons: /etc/rc.d/rc.xencommons&amp;#34;
/etc/rc.d/rc.xencommons stop
fi
fi
&lt;/code>&lt;/pre>&lt;/div>&lt;p>After the reboot, you should get something like this:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ uname -r
3.2.28-xen
$ cat /proc/xen/capabilities
control_d
$ cat /sys/hypervisor/properties/capabilities
xen-3.0-x86_64 xen-3.0-x86_32p hvm-3.0-x86_32 hvm-3.0-x86_32p hvm-3.0-x86_64
$ xl list
Name ID Mem VCPUs State Time&lt;span style="color:#f92672">(&lt;/span>s&lt;span style="color:#f92672">)&lt;/span>
Domain-0 &lt;span style="color:#ae81ff">0&lt;/span> &lt;span style="color:#ae81ff">15243&lt;/span> &lt;span style="color:#ae81ff">12&lt;/span> r----- 9.0
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Disable autosave and restore of &lt;code>DomU&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-txt" data-lang="txt"># /etc/default/xendomains
XENDOMAINS_RESTORE=false
XENDOMAINS_SAVE=&amp;#34;&amp;#34;
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="setup-domu-guest">Setup DomU (Guest)&lt;/h2>
&lt;p>I&amp;rsquo;m going to install a Slackware v13.37 64 bit as the first guest. I&amp;rsquo;ll be using
an ISO image that I&amp;rsquo;ve copied into my &lt;code>/iso&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">cd /iso
wget http://mirrors.xmission.com/slackware/slackware64-13.37-iso/slackware64-13.37-install-dvd.iso
&lt;/code>&lt;/pre>&lt;/div>&lt;p>For a start, we need to create a config file for the Slackware installation:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">mkdir ~/machines
cd ~/machines
vim slackware-install
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Put these initial configs in your &lt;code>/root/machines/slackware-install&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-txt" data-lang="txt">kernel = &amp;#39;hvmloader&amp;#39;
builder=&amp;#39;hvm&amp;#39;
memory = 1024
name = &amp;#34;slackware&amp;#34;
vif = [ &amp;#39;mac=00:16:3E:AD:81:AE, bridge=virbr0, model=e1000&amp;#39; ]
dhcp = &amp;#34;dhcp&amp;#34;
disk = [&amp;#39;phy:/dev/vg01/slackware,hda,w&amp;#39;, &amp;#39;file:/iso/slackware64-13.37-install-dvd.iso,hdc:cdrom,r&amp;#39;]
boot=&amp;#39;dc&amp;#39;
sdl=0
opengl=1
vnc=1
vncpasswd=&amp;#39;&amp;#39;
serial=&amp;#39;pty&amp;#39;
&lt;/code>&lt;/pre>&lt;/div>&lt;p>As you can see, there&amp;rsquo;re various of thing thats we need to take care of before
we start the installation. First of all the networking.&lt;/p>
&lt;h3 id="generate-random-mac">Generate Random MAC&lt;/h3>
&lt;p>Use this command (thanks to &lt;a href="http://unixtitan.net/main/2009/12/01/xen-mac-generator/">Unixtitan&lt;/a>):&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">perl -e &lt;span style="color:#e6db74">&amp;#39;printf &amp;#34;00:16:3E:%02X:%02X:%02X\n&amp;#34;, rand 0xFF, rand 0xFF, rand 0xFF&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="setup-networking-bridging">Setup Networking Bridging&lt;/h3>
&lt;p>There are a few methods for a DomU to access the network. For this guide, I&amp;rsquo;ll
use network bridging.&lt;/p>
&lt;p>Put these configs (before starting anything related to Xen) into your &lt;code>/etc/rc.d/rc.local&lt;/code> to enable network bridge:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-txt" data-lang="txt"># /etc/rc.d/rc.local
ifconfig eth0 up
ifconfig eth0 0.0.0.0
brctl addbr virbr0
brctl addif virbr0 eth0
ifconfig virbr0 192.168.1.10 netmask 255.255.255.0
route add default gw 192.168.1.1
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Clear out any values set in your &lt;code>/etc/rc.d/rc.inet1.conf&lt;/code>. Usually the value of
&lt;code>IPADDR[0]&lt;/code>, &lt;code>NETMASK[0]&lt;/code> and &lt;code>GATEWAY&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-txt" data-lang="txt"># /etc/rc.d/rc.inet1.conf
# Config information for eth0:
IPADDR[0]=&amp;#34;&amp;#34;
NETMASK[0]=&amp;#34;&amp;#34;
USE_DHCP[0]=&amp;#34;&amp;#34;
DHCP_HOSTNAME[0]=&amp;#34;&amp;#34;
# Default gateway IP address:
GATEWAY=&amp;#34;&amp;#34;
&lt;/code>&lt;/pre>&lt;/div>&lt;p>This configs assume your main networking interface is &lt;code>eth0&lt;/code>. Change other
settings based on your network environment. Reboot your &lt;code>Dom0&lt;/code>.&lt;/p>
&lt;p>You&amp;rsquo;ll get something that looks like this after the reboot (if you got it right).&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-txt" data-lang="txt">$ ifconfig
eth0 Link encap:Ethernet HWaddr bc:30:5b:db:e2:99
inet6 addr: fe80::be30:5bff:fedb:e299/64 Scope:Link
UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1
RX packets:163836 errors:0 dropped:0 overruns:0 frame:0
TX packets:337 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:1000
RX bytes:18347806 (17.4 MiB) TX bytes:30535 (29.8 KiB)
Interrupt:36 Memory:d6000000-d6012800
lo Link encap:Local Loopback
inet addr:127.0.0.1 Mask:255.0.0.0
inet6 addr: ::1/128 Scope:Host
UP LOOPBACK RUNNING MTU:16436 Metric:1
RX packets:4 errors:0 dropped:0 overruns:0 frame:0
TX packets:4 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:0
RX bytes:336 (336.0 B) TX bytes:336 (336.0 B)
virbr0 Link encap:Ethernet HWaddr bc:30:5b:db:e2:99
inet addr:192.168.1.10 Bcast:192.168.1.255 Mask:255.255.255.0
inet6 addr: fe80::be30:5bff:fedb:e299/64 Scope:Link
UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1
RX packets:147426 errors:0 dropped:506 overruns:0 frame:0
TX packets:129 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:0
RX bytes:12417385 (11.8 MiB) TX bytes:16779 (16.3 KiB)
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="enable-x11-forwarding-in-dom0">Enable X11 Forwarding in Dom0&lt;/h3>
&lt;ul>
&lt;li>Install &lt;a href="http://slackbuilds.org/repository/12.2/system/vncviewer/">vncviewer&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>Uncomment or create these options in your &lt;code>/etc/ssh/sshd_config&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-txt" data-lang="txt"># /etc/ssh/sshd_config
X11Forwarding yes
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Restart your &lt;code>ssh&lt;/code> server:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">/etc/rc.d/rc.sshd restart
exit
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Reconnect to &lt;code>Dom0&lt;/code> using &lt;code>-Y&lt;/code> option:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">ssh -Y root@192.168.1.10
xclock
&lt;/code>&lt;/pre>&lt;/div>&lt;p>If you can see a clock ticking, that means the X11 forward is working.&lt;/p>
&lt;h3 id="prepare-space-for-domu">Prepare space for DomU&lt;/h3>
&lt;p>I&amp;rsquo;m going to store my &lt;code>DomU&lt;/code> in the a new logical volume.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">lvcreate -L 15G -n slackware vg01
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="install-slackware-in-domu">Install Slackware in DomU&lt;/h3>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">cd machines
xl create slackware
&lt;/code>&lt;/pre>&lt;/div>&lt;p>If everything is good, you should see &lt;code>slackware&lt;/code> when you run &lt;code>xl list&lt;/code>.&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-txt" data-lang="txt">$ xl list
Name ID Mem VCPUs State Time(s)
Domain-0 0 13988 12 r----- 40.0
slackware 2 1019 1 -b---- 4.6
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Install Slackware through VNC:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">xl vncviewer slackware
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Just install as if you&amp;rsquo;re installing on a normal server. &lt;code>halt&lt;/code> after you&amp;rsquo;ve finished your installation.&lt;/p>
&lt;h3 id="start-slackware-in-domu">Start Slackware in DomU&lt;/h3>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">cd ~/machines
cp slackware-install slackware
vim slackware
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Change these two lines in your config file to make sure it&amp;rsquo;ll boot from the hardisk:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-txt" data-lang="txt"># /root/machines/slackware
disk = [&amp;#39;phy:/dev/vg01/slackware,hda,w&amp;#39;]
boot=&amp;#39;c&amp;#39;
&lt;/code>&lt;/pre>&lt;/div>&lt;p>Start the guest:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">xl create slackware
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="enable-console-in-domu">Enable Console in DomU&lt;/h3>
&lt;p>It&amp;rsquo;s pretty annoying to use vnc everytime we need to access our &lt;code>DomU&lt;/code> directly. It&amp;rsquo;s possible to connect to our &lt;code>DomU&lt;/code> using console connection:&lt;/p>
&lt;p>Uncomment these lines:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#75715e"># /etc/inittab&lt;/span>
s1:12345:respawn:/sbin/agetty -L ttyS0 &lt;span style="color:#ae81ff">9600&lt;/span> vt100
&lt;span style="color:#75715e"># /etc/securetty&lt;/span>
ttyS0
$ reboot
&lt;/code>&lt;/pre>&lt;/div>&lt;p>For Ubuntu&amp;rsquo;s &lt;code>DomU&lt;/code>, please check out &lt;a href="https://help.ubuntu.com/community/SerialConsoleHowto">https://help.ubuntu.com/community/SerialConsoleHowto&lt;/a>.&lt;/p>
&lt;p>You can now connect to your Slackware DomU using:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">xl console slackware
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="additional-info">Additional Info&lt;/h2>
&lt;p>Disable auto save and restore of domUs on host reboot:&lt;/p>
&lt;div class="highlight">&lt;pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-txt" data-lang="txt">$ vim /etc/default/xendomains
XENDOMAINS_RESTORE=false
XENDOMAINS_SAVE=&amp;#34;&amp;#34;
&lt;/code>&lt;/pre>&lt;/div>&lt;p>In order to run &lt;code>xl shutdown guest&lt;/code> so that your &lt;code>DomU&lt;/code> will shutdown
gracefully, you need to use &lt;a href="http://wiki.xen.org/wiki/Xen_Linux_PV_on_HVM_drivers">PVHVM
drivers&lt;/a>. You can refer
&lt;a href="http://wiki.xen.org/wiki/Mainline_Linux_Kernel_Configs">here&lt;/a> for the related
kernel configs that you need to enable in your kernel.&lt;/p>
&lt;p>There are still many things that I&amp;rsquo;d like to add, but I think it&amp;rsquo;s good enough
for now. After all, this post is about getting started, not a complete guide.
I&amp;rsquo;ll update this post if I found anything worth of sharing.&lt;/p>
&lt;p>Good luck!&lt;/p>
&lt;p>More references:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="http://wiki.xen.org/wiki/XenCommonProblems">http://wiki.xen.org/wiki/XenCommonProblems&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://wiki.xen.org/wiki/Xen_Best_Practices">http://wiki.xen.org/wiki/Xen_Best_Practices&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://wiki.xen.org/wiki/Xen_Linux_PV_on_HVM_drivers">http://wiki.xen.org/wiki/Xen_Linux_PV_on_HVM_drivers&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://alien.slackbook.org/dokuwiki/doku.php?id=linux:kernelbuilding">http://alien.slackbook.org/dokuwiki/doku.php?id=linux:kernelbuilding&lt;/a>&lt;/li>
&lt;/ul></content></item></channel></rss>