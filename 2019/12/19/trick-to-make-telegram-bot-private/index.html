<!doctype html><html lang=en><head><title>Trick to Make Telegram Bot Private :: Amree Zaid</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Recently, I learned a trick to make my Telegram bot private to certain users.
I tried not to create the whole CRUD thingy for the membership and after Googling I found out about one of the API provided.
"><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=https://amree.github.io/2019/12/19/trick-to-make-telegram-bot-private/><link rel=stylesheet href=https://amree.github.io/assets/style.css><link rel=stylesheet href=https://amree.github.io/assets/green.css><link rel=apple-touch-icon href=https://amree.github.io/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=https://amree.github.io/img/favicon/green.png><meta name=twitter:card content="summary"><meta name=twitter:site content><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Trick to Make Telegram Bot Private"><meta property="og:description" content="Recently, I learned a trick to make my Telegram bot private to certain users.
I tried not to create the whole CRUD thingy for the membership and after Googling I found out about one of the API provided.
"><meta property="og:url" content="https://amree.github.io/2019/12/19/trick-to-make-telegram-bot-private/"><meta property="og:site_name" content="Amree Zaid"><meta property="og:image" content="https://amree.github.io/img/favicon/green.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2019-12-19 00:00:00 +0000 UTC"></head><body class=green><div class="container center headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>Amree Zaid</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/all-posts>All Posts</a></li><li><a href=https://twitter.com/AmreeZaid>Twitter</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/all-posts>All Posts</a></li><li><a href=https://twitter.com/AmreeZaid>Twitter</a></li></ul></nav></header><div class=content><div class=post><h1 class=post-title><a href=https://amree.github.io/2019/12/19/trick-to-make-telegram-bot-private/>Trick to Make Telegram Bot Private</a></h1><div class=post-meta><span class=post-date>2019-12-19</span></div><span class=post-tags>#<a href=https://amree.github.io/tags/telegram/>telegram</a>&nbsp;
#<a href=https://amree.github.io/tags/ruby/>ruby</a>&nbsp;</span><div class=post-content><div><p>Recently, I learned a trick to make my Telegram bot private to certain users.</p><p>I tried not to create the whole CRUD thingy for the membership and after
Googling I found out about one of the API provided.</p><p><a href=https://core.telegram.org/bots/api#getchatmember>https://core.telegram.org/bots/api#getchatmember</a></p><p>This would allow us to get info of a user with a given <code>chat_id</code>. It can be a
channel or a group.</p><p>Basically your membership for your bot will be based on the group of your bot
and the allowed users are in. So, both of them need to be in the same
group/channel.</p><p>The code would look like the screenshot.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ruby data-lang=ruby>bot<span style=color:#f92672>.</span>api<span style=color:#f92672>.</span>get_chat_member(<span style=color:#e6db74>chat_id</span>: <span style=color:#f92672>-</span><span style=color:#ae81ff>10012345678</span>, <span style=color:#e6db74>user_id</span>: message<span style=color:#f92672>.</span>from_id)
</code></pre></div><p>There&rsquo;re a few things to note:</p><p><strong>We need to get the channel and id of the group</strong></p><p>For group:</p><p>Invite <a href=https://t.me/RawDataBot>https://t.me/RawDataBot</a> and on the first entry, it&rsquo;ll output some JSON.
You can get the group&rsquo;s ID from <code>message.chat.id</code>.</p><p>It should look like <code>-10012345678</code>. Remove the bot after that. But if you don&rsquo;t
trust the bot, you probably need to cook up some new code to get the group ID.</p><p>For channel:</p><p>Channel is a little bit different, you can use one of the methods mentioned
here:</p><p><a href=https://stackoverflow.com/questions/33858927/how-to-obtain-the-chat-id-of-a-private-telegram-channel/56546442#56546442>https://stackoverflow.com/questions/33858927/how-to-obtain-the-chat-id-of-a-private-telegram-channel/56546442#56546442</a></p><p><strong>Output</strong></p><p>So, what&rsquo;s the output can we expect? Well for Ruby, we&rsquo;re expecting hash from
the output and <code>var["result"]["status"]</code> will give you the status of the user.</p><p>It can be many things, but if it&rsquo;s <code>left</code> then the user is not a member of the
group and that&rsquo;s what we want to know.</p><p><strong>Add the bot to a group/channel</strong></p><p>This also means you need to add the bot that&rsquo;s executing the code to be in the
same group as those users that you want to give access to.</p><p>So, any users who are in the same group/channel will be allowed to chat with the
bot based on the previous output.</p><p>Again, a channel is a little bit different, you need to add your bot as the
admin, compared to a group that can be added as a normal user.</p><p><strong>Exception</strong></p><p>Another note, the code will raise an exception if the given <code>chat_id</code> doesn&rsquo;t
exist.</p><p>As a summary, with this trick, you don&rsquo;t have to build the whole CRUD and can
reuse the group/channel that you already have (assuming you have one).</p><p>That&rsquo;s it, folks, thanks for reading</p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://amree.github.io/2020/02/02/rails-6-with-bootstrap-webpacker-for-js-asset-pipeline-for-css/><span class=button__icon>←</span>
<span class=button__text>Rails 6 with Bootstrap (Webpacker for JS, Asset Pipeline for CSS)</span></a></span>
<span class="button next"><a href=https://amree.github.io/2019/01/19/how-bcrypt-compares-password/><span class=button__text>How Bcrypt Compares Password</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2021 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=https://amree.github.io/assets/main.js></script><script src=https://amree.github.io/assets/prism.js></script></div></body></html>